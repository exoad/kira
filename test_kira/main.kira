module "test:main"

fx helperCreateMap(): Map<Str, Int32> {
    return { "one": 1, "two": 2, "three": 3 }
}

pub class Point {
    require pub mut x: Int32
    require pub mut y: Int32

    pub fx dist(): Float64 {
        return (x * x + y * y) as Float64
    }
}

trait Printable {
    fx toStr(): Str
}

pub class Circle {
    require pub center: Point
    require pub mut radius: Int32

    pub fx area(): Float64 {
        return 3.14159 * (radius as Float64) * (radius as Float64)
    }
}

enum Color {
    RED = "red",
    GREEN = "green",
    BLUE = "blue"
}

fx compute(values: List<Int32>): Int32 {
    mut acc: Int32 = 0
    for mut i: 0..(values.size() - 1) {
        acc = acc + values[i]
    }
    return acc
}

fx main(): Void {
    nums: List<Int32> = mut [1, 2, 3, 4, 5]
    arr: Arr<Int32> = [10, 20, 30]
    @trace(nums)
    total: Int32 = compute(nums)
    @trace(total)
    p: Point = Point { 3, 4 }
    @trace(p.dist())
    c: Circle = Circle { p, 5 }
    @trace(c.area())
    col: Color = Color.RED
    @trace(col)
    if total % 2 == 0 {
        @trace("total is even")
    } else if total % 3 == 0 {
        @trace("divisible by 3")
    } else {
        @trace("other")
    }
    mut i: Int32 = 0
    while i < 3 {
        @trace(i)
        i = i + 1
    }
    do {
        @trace("one-time")
    } while false
    for mut k: 0..2 {
        @trace(k)
    }
    for mut idx: 0..(arr.size() - 1) {
        @trace(arr[idx])
    }
    fxSum: Int32 = (fx(a: Int32, b: Int32): Int32 { return a + b })(1, 2)
    @trace(fxSum)
    try {
        throw "boom"
    } on e: Str {
        @trace(e)
    }
}

pub class Box<T> {
    require pub value: T
}

pub class Container<K, V> {
    require pub mapping: Map<K, List<Arr<V>>>
}

pub class Deep {
    require pub data: Map<Map<Str, List<Arr<Int32>>>, Arr<Arr<Int32>>>
}

fx genericIdentity<T: Int32>(x: T): T {
    return x
}

fx nestedGenerics(): Map<Map<Map<Str, Str>, List<Int32>>, Arr<Arr<Int32>>> {
    return helperCreateMap()
}

complexVar: Map<Map<Str, List<Arr<Int32>>>, Arr<Arr<Int32>>> = helperCreateMap()
